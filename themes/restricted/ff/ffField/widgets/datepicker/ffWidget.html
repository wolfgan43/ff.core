<!--BeginSectHeaders-->
<!--EndSectHeaders-->

<!--BeginSectFooters-->
<script type="text/javascript">
	<!--BeginSectBinding-->
	ff.pluginAddInit("jquery-ui", function() {
		var startDate;
		var endDate;
		
		var baseAttachHandler = jQuery.datepicker._attachHandlers;
		jQuery.datepicker._attachHandlers = function(inst) {
				baseAttachHandler.apply(this, [inst]);
				
				var element_data = jQuery._data(inst.dpDiv.get(0));
				var ori_handler_mouseover = element_data.events.mouseover[0].handler;
				var ori_handler_mouseout = element_data.events.mouseout[0].handler;
				
				// remove handlers
				inst.dpDiv.undelegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a", 'mouseover');
				inst.dpDiv.undelegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a", 'mouseout');
				inst.dpDiv.undelegate("button, .ui-datepicker-prev, .ui-datepicker-next", 'mouseover');
				inst.dpDiv.undelegate("button, .ui-datepicker-prev, .ui-datepicker-next", 'mouseout');
				inst.dpDiv.find(".ui-datepicker-calendar tr").unbind('mouseover');
				inst.dpDiv.find(".ui-datepicker-calendar tr").unbind('mouseout');
				
				// attach proper ones
				if (this._get(inst, "weekSelector")) {
					inst.dpDiv.delegate("button, .ui-datepicker-prev, .ui-datepicker-next", 'mouseover', ori_handler_mouseover);
					inst.dpDiv.delegate("button, .ui-datepicker-prev, .ui-datepicker-next", 'mouseout', ori_handler_mouseout);
					inst.dpDiv.find(".ui-datepicker-calendar tr").bind('mouseover', function() { 
						jQuery(this).find('td a').addClass('ui-state-hover');
					});
					inst.dpDiv.find(".ui-datepicker-calendar tr").bind('mouseout', function() { 
						jQuery(this).find('td a').removeClass('ui-state-hover');
					});
				} else {
					inst.dpDiv.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a", 'mouseover', ori_handler_mouseover);
					inst.dpDiv.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a", 'mouseout', ori_handler_mouseout);
				}
			};
			
		jQuery.datepicker.calcWeekBoundaries = function () {
			var sDate;
			var eDate;
			var date = jQuery(this).datepicker('getDate');
			if (date) {
				eDate = new Date(date.getTime());
				sDate = new Date(date.getTime());
				var tmp = date.getDay();
				if (tmp == 0) { // starting with monday
					sDate.setDate(sDate.getDate() - 6);
				} else {
					sDate.setDate(sDate.getDate() - (tmp - 1));
					eDate.setDate(eDate.getDate() + (7 - tmp));
				}
			}
			
			return [sDate, eDate];
		};

        <!--BeginSectDate-->
		jQuery.fn.escapeGet("{container}{id}").datepicker(
			jQuery.extend({}, jQuery.datepicker.regional["{lang}"], {
				showOn: '{showOn}'
			<!--BeginSectButton-->
				, buttonImage: '{widget_path}/calendar.png' 
				, buttonImageOnly: true
			<!--EndSectButton-->
				, showOtherMonths: true
				, selectOtherMonths: true
				, changeMonth: true
				, changeYear: true
				, yearRange: "-{min_year}:+{max_year}"
				, onSelect: function(dateText, inst) { 
					if (jQuery.datepicker._get(inst, "weekSelector")) {
						var ret = jQuery.datepicker.calcWeekBoundaries.apply(this, []);
						if (ret[0] !== undefined)
							jQuery(this).datepicker('setDate', ret[0]);
						//var dateFormat = inst.settings.dateFormat || jQuery.datepicker._defaults.dateFormat;
						//jQuery('#startDate').text(jQuery.datepicker.formatDate( dateFormat, startDate, inst.settings ));
						//jQuery('#endDate').text(jQuery.datepicker.formatDate( dateFormat, endDate, inst.settings ));
					}
					inst.input.trigger("change");
				}
				, beforeShowDay: function(date) {
					var inst = jQuery.data(this, "datepicker");
					var cssClass = '';
					if (jQuery.datepicker._get(inst, "weekSelector") && date) {
						if(date >= startDate && date <= endDate) {
							cssClass = 'ui-state-active';
						}
					}
					return [true, cssClass];
				}
				, beforeShow: function(input, inst) {
					jQuery.datepicker.calcWeekBoundaries.apply(this, []);
				}
				<!--BeginSectWeek-->
				, weekSelector: true
			    <!--EndSectWeek-->
			})
		);
        <!--EndSectDate-->
        <!--BeginSectDateTime-->
        ff.pluginAddInit("jquery-ui.timepicker", function() {
            jQuery.fn.escapeGet("{container}{id}").datetimepicker(
				jQuery.extend({}, jQuery.datepicker.regional["{lang}"], {
					showOn: 'button'
					, buttonImage: '{widget_path}/calendar.png' 
					, buttonImageOnly: true
					, changeMonth: true
					, changeYear: true
					, yearRange: "-{min_year}:+{max_year}"
					, timeFormat: 'HH:mm:ss'
					, timeOnlyTitle: '{_datepicker_choose}'
					, timeText: '{_datepicker_time}'
					, hourText: '{_datepicker_hour}'
					, minuteText: '{_datepicker_minute}'
					, secondText: '{_datepicker_second}'
					, currentText: '{_datepicker_current}'
					, closeText: '{_datepicker_close}'
					, showButtonPanel: false
					, onSelect: function(dateText, inst) { 
						if (jQuery.datepicker._get(inst, "weekSelector")) {
							jQuery.datepicker.calcWeekBoundaries.apply(this, []);
							jQuery(this).datepicker('setDate', startDate);
							//var dateFormat = inst.settings.dateFormat || jQuery.datepicker._defaults.dateFormat;
							//jQuery('#startDate').text(jQuery.datepicker.formatDate( dateFormat, startDate, inst.settings ));
							//jQuery('#endDate').text(jQuery.datepicker.formatDate( dateFormat, endDate, inst.settings ));
						}
						inst.input.trigger("change");
					}
					, beforeShowDay: function(date) {
						var inst = jQuery.data(this, "datepicker");
						var cssClass = '';
						if (jQuery.datepicker._get(inst, "weekSelector") && date) {
							if(date >= startDate && date <= endDate) {
								cssClass = 'ui-state-active';
							}
						}
						return [true, cssClass];
					}
					, beforeShow: function(input, inst) {
						jQuery.datepicker.calcWeekBoundaries.apply(this, []);
					}
			        <!--BeginSectWeek-->
			        <!--EndSectWeek-->
				})
            );
        });
        <!--EndSectDateTime-->
		/*ff.doEvent({
			"event_name" : "initIFElement"
			, "event_params" : ["{container}{id}", "datepicker"]
		});*/
	});
	<!--EndSectBinding-->
</script>
<!--EndSectFooters-->

<!--BeginSectControl-->
<input type="text" id="{container}{id}" name="{container}{id}" value="{value}" class="{class}_text" {properties} />
<!--EndSectControl-->
